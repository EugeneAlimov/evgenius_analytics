"use strict";(self.webpackChunkinterface=self.webpackChunkinterface||[]).push([[509],{4817:function(e,t,n){var r=n(885),a=n(2791),i=function(){var e=window;return[e.innerWidth,e.innerHeight]};t.Z=function(){var e=(0,a.useState)(i()),t=(0,r.Z)(e,2),n=t[0],s=t[1];return(0,a.useEffect)((function(){function e(){s(i())}return window.addEventListener("resize",e),function(){return window.removeEventListener("resize",e)}}),[]),n}},6225:function(e,t,n){n.r(t),n.d(t,{default:function(){return le}});var r=n(4942),a=n(1413),i=n(4165),s=n(5861),o=n(885),l=n(2791),c=n(9434),d=n(9338),u=n(6571),h=n(7205),x=n(3717),f=n(7952),p=n(228),g=n(8916),m=n(4565),b=n(6650),Z=n(476),v=n(4162),j=n(277),y=n(9308),w=n(9840),k=n(3245),C=n(7962),S=n(7463),T=n(3329),A=function(e){var t=e.closePopperHandle,n=e.isPopOpen,r=e.popAnchorEl,i=e.popPlacement,s=(0,l.useState)(""),c=(0,o.Z)(s,2),d=c[0],u=c[1];return(0,T.jsx)(k.Z,{open:n,anchorEl:r,placement:i,transition:!0,children:function(e){var n=e.TransitionProps;return(0,T.jsx)(C.Z,(0,a.Z)((0,a.Z)({},n),{},{timeout:350,children:(0,T.jsx)(b.Z,{sx:{p:2,m:2},elevation:10,children:(0,T.jsxs)(v.Z,{spacing:2,children:[(0,T.jsx)(S.Z,{value:d,onChange:function(e){return u(e.currentTarget.value)},id:"outlined-search",label:"Enter dataset name",type:"search",size:"large",autoFocus:!0}),(0,T.jsx)(h.Z,{onClick:function(){t(d,!0),u("")},sx:{width:"100%",height:"50px"},variant:"contained",size:"large",children:"Save"}),(0,T.jsx)(h.Z,{onClick:function(){t(d,!1),u("")},sx:{width:"100%",height:"50px"},variant:"contained",size:"large",children:"Cansel"})]})})}))}})},_=n(2982),P=n(5814),z=n(6132),H=n(9978),D=n(9520),E=n(8823),M=n(1048),L=n(2262),O=n(2338),I=n(2494),R=function(e){var t=e.height,n=e.checkTags,r=e.selectedTags,i=(0,c.I0)(),s=(0,c.v9)((function(e){return e.analytic.tags})),d=(0,c.v9)((function(e){return e.analytic.groups})),u=(0,l.useState)(null),h=(0,o.Z)(u,2),x=h[0],f=h[1],g=(0,l.useState)(""),Z=(0,o.Z)(g,2),j=Z[0],y=Z[1],w=(0,l.useState)(null),k=(0,o.Z)(w,2),C=k[0],A=k[1],R=(0,l.useState)([]),W=(0,o.Z)(R,2),F=W[0],q=W[1],Y=(0,l.useState)([]),G=(0,o.Z)(Y,2),N=G[0],Q=G[1];(0,l.useEffect)((function(){f(C)}),[C]),(0,l.useEffect)((function(){if(null!==x){var e=s.filter((function(e){return e.label===x.label}));q(e)}else q(s)}),[x,s]),(0,l.useEffect)((function(){var e=F.filter((function(e){return e.name_tag.toLowerCase().includes(j.toLowerCase())}));Q(e)}),[F,j]);var U=N.length,J=t-282;return(0,T.jsxs)(b.Z,{sx:{p:2,m:2,height:t-64,width:"420px"},elevation:10,square:!0,children:[(0,T.jsx)(p.Z,{component:"div",mb:0,p:1,sx:{border:"none",minHeight:"10px"},children:(0,T.jsx)(m.Z,{display:"block",sx:{color:"#666666",fontSize:26,ml:2},children:"Please, select a tags from list"})}),(0,T.jsx)(b.Z,{sx:{m:0},elevation:5,square:!0,children:(0,T.jsx)(p.Z,{component:"div",mb:2,p:2,sx:{border:"none",minHeight:"10px"},children:(0,T.jsxs)(v.Z,{direction:"column",spacing:3,children:[(0,T.jsx)(S.Z,{value:j,onChange:function(e){return y(e.currentTarget.value)},sx:{offset:100},id:"outlined-search",label:"Search tag",type:"search",size:"small"}),(0,T.jsx)(L.Z,{size:"small",disablePortal:!0,id:"combo-box-demo",options:d,sx:{offset:100},freeSolo:!0,value:C,onChange:function(e,t){A(t)},renderInput:function(e){return(0,T.jsx)(S.Z,(0,a.Z)((0,a.Z)({},e),{},{label:"Filter by group"}))}})]})})}),(0,T.jsx)(O.t7,{height:J,width:"100%",itemSize:64,itemCount:U,layout:"vertical",overscanCount:8,children:function(e){var t=e.index,a=e.style;return(0,T.jsx)(P.Z,{placement:"right",title:(0,T.jsxs)(m.Z,{sx:{m:0},paragraph:!0,children:["Address: ",N[t].address,(0,T.jsx)("br",{}),"Datatype: ",N[t].data_type,(0,T.jsx)("br",{}),"Tagtable: ",N[t].tag_table,(0,T.jsx)("br",{}),"Comment: ",N[t].comment,(0,T.jsx)("br",{}),"Group: ",N[t].label]}),style:a,children:(0,T.jsx)(z.ZP,{divider:!0,dense:!0,children:(0,T.jsxs)(H.Z,{role:void 0,onClick:function(){return function(e){var t=(0,_.Z)(r),a=r.find((function(t){return t.id===e})),o=(0,I.Z)(s,e);a?(t=r.filter((function(t){return t.id!==e})),console.log(t,a)):t.push(s[o]),i(n(t))}(N[t].id)},dense:!0,children:[(0,T.jsx)(D.Z,{sx:{minWidth:"35px"},children:(0,T.jsx)(E.Z,{edge:"start",checked:!!r.find((function(e){return e.id===N[t].id})),tabIndex:-1,disableRipple:!0,inputProps:{"aria-labelledby":N[t].id}})}),(0,T.jsx)(M.Z,{id:N[t].id,primary:(0,T.jsxs)(m.Z,{sx:{m:0,overflowWrap:"break-word"},paragraph:!0,noWrap:!1,children:[N[t].name_tag," ",(0,T.jsx)("br",{})]})})]})})},t)}})]})},W=n(5629),F=n(3811),q=n(7247),Y=function(e){var t=e.height,n=e.checkTags,r=e.selectedTags;console.log(r);var a=(0,c.I0)();return(0,T.jsxs)(b.Z,{sx:{p:2,m:2,height:t-64,width:"420px"},elevation:10,square:!0,children:[(0,T.jsx)(p.Z,{component:"div",mb:0,p:1,sx:{border:"none",minHeight:"10px"},children:(0,T.jsx)(m.Z,{display:"block",sx:{color:"#666666",fontSize:26,ml:2},children:"Selected tags"})}),(0,T.jsx)(W.Z,{style:{overflowY:"scroll",height:"".concat(t-146,"px"),paddingRight:"12px",bgcolor:"background.paper"},children:r.map((function(e,t){var i="checkbox-list-label-".concat(e),s=e.id,o=e.name_tag,l=e.tag_table,c=e.address,d=e.data_type,u=e.comment,h=e.label;return(0,T.jsx)(P.Z,{placement:"right",title:(0,T.jsxs)(m.Z,{sx:{m:0,overflowWrap:"break-word"},paragraph:!0,children:["Address: ",c,(0,T.jsx)("br",{}),"Datatype: ",d,(0,T.jsx)("br",{}),"Tagtable: ",l,(0,T.jsx)("br",{}),"Comment: ",u]}),children:(0,T.jsxs)(z.ZP,{divider:!0,dense:!0,children:[(0,T.jsx)(M.Z,{id:i,primary:(0,T.jsxs)(m.Z,{sx:{m:0,overflowWrap:"break-word"},paragraph:!0,children:["TAG: ",o,(0,T.jsx)("br",{}),"GROUP: ",h]})}),(0,T.jsx)(F.Z,{onClick:function(){return function(e){var t=(0,_.Z)(r);t.splice(e,1),a(n(t))}(t)},edge:"end","aria-label":"comments",children:(0,T.jsx)(q.Z,{})})]})},s)}))})]})},G=n(1741),N=function(e){var t=e.label,n=e.handler,r=e.value;return(0,T.jsx)(G.h,{inputFormat:"yy:MM:dd-HH:mm:ss",views:["year","month","day","hours","minutes","seconds"],ampm:!1,label:t,value:r,onChange:function(e){n(e)},renderInput:function(e){return(0,T.jsx)(S.Z,(0,a.Z)({},e))},maxDateTime:Date.now()})},Q=n(788),U=n(7323),J=n(8440),B=n(9571),V=n(464);function K(e){var t=e.alertOpen,n=e.setAlertStateHandler,r=e.alertMessage;return(0,T.jsx)("div",{children:(0,T.jsxs)(Q.Z,{open:t,onClose:function(){n(!1)},"aria-labelledby":"alert-dialog-title","aria-describedby":"alert-dialog-description",children:[(0,T.jsx)(V.Z,{id:"alert-dialog-title",children:"You fogot something"}),(0,T.jsx)(J.Z,{children:(0,T.jsx)(B.Z,{id:"alert-dialog-description",children:r})}),(0,T.jsx)(U.Z,{children:(0,T.jsx)(h.Z,{onClick:function(){n(!1)},autoFocus:!0,children:"Ok"})})]})})}var X=n(4622),$=n(4817),ee=n(6296),te=n(4771),ne=function(e,t){console.log("dataSetArr: ",t),console.log("checkedArr: ",e);var n=["rgba(239, 71, 111, 0.5)","rgba(255, 209, 102, 0.5)","rgba(64, 97, 84, 0.5)","rgba(17, 138, 178, 0.5)","rgba(255, 99, 30, 0.5)","rgba(249, 248, 83, 1.0)","rgba(53, 82, 235, 0.5)","rgba(78, 155, 30, 0.5)","rgba(153, 32, 135, 0.5)","rgba(138, 155, 110, 1.0)"],r=["rgba(239, 71, 111, 0.7)","rgba(255, 209, 132, 0.9)","rgba(164, 97, 84, 0.7)","rgba(17, 138, 178, 0.7)","rgba(255, 99, 30, 0.7)","rgba(249, 248, 83, 0.7)","rgba(53, 82, 235, 0.7)","rgba(78, 155, 30, 0.7)","rgba(153, 32, 135, 0.7)","rgba(138, 155, 110, 0.5)"],a={},i={animation:!1,parsing:!1,responsive:!0,interaction:{mode:"index",intersect:!1},stacked:!1,plugins:{decimation:{enabled:!0,algorithm:"lttb",samples:80,threshold:80},title:{text:"Chart.js Line Chart - Multi Axis"},zoom:{pan:{enabled:!0,mode:"xy",overScaleMode:"xy"},zoom:{wheel:{enabled:!0},mode:"xy",overScaleMode:"xy"}}},scales:{x:{type:"timeseries"}}},s=e.length,o="",l=Array.from({length:s},(function(){return{data:[]}}));return t.forEach((function(e){o!==e._field&&(l[e.table].label=e._field,o=e._field,l[e.table].borderColor=n[e.table],l[e.table].backgroundColor=r[e.table],l[e.table].yAxisID=o,l[e.table].radius=0,i.scales[o]={beginAtZero:!0,type:"linear",display:!0,position:e.table%2?"left":"right",backgroundColor:n[e.table],grid:{drawOnChartArea:!0},min:0}),l[e.table].data.push({x:new Date(e._time).getTime(),y:Math.round10(e._value,-2)})})),a.datasets=l,{data:a,options:i}};function re(){return(re=(0,s.Z)((0,i.Z)().mark((function e(t,n,r){var a,s,o,l,c,d,u,h,x,f,p,g,m,b,Z,v,j,y,w,k,C,S;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a=n.toISOString(),s=r.toISOString(),o=[],l=t.map((function(e){return"".concat(e.name_tag," - ").concat(e.label)})),c="",l.forEach((function(e){c+='r._field == "'.concat(e,'" or ')})),c=c.slice(0,c.length-4),"http://192.168.8.167:8086/","AYxGUOAj0Ho1vqmyMeQDpHPaSPYNcTZznrQ9bDJCvNM9fvF6tAepPH6jyxuTaalmbqgZKe98efDVoCFAyu6kJw==","evgenius","Line","Line",d=new te.Ni({url:"http://192.168.8.167:8086/",token:"AYxGUOAj0Ho1vqmyMeQDpHPaSPYNcTZznrQ9bDJCvNM9fvF6tAepPH6jyxuTaalmbqgZKe98efDVoCFAyu6kJw=="}).getQueryApi("evgenius"),u='from(bucket: "'.concat("Line",'")\n        |> range(start: ').concat(a,", stop: ").concat(s,')\n        |> filter(fn: (r) => r._measurement == "').concat("Line",'")\n        |> filter(fn: (r) => ').concat(c,")\n        "),console.log(u),h=!1,x=!1,e.prev=17,p=(0,ee.Z)(d.iterateRows(u));case 19:return e.next=21,p.next();case 21:if(!(h=!(g=e.sent).done)){e.next=29;break}m=g.value,b=m.values,Z=m.tableMeta,v=Z.toObject(b),y=(j=v).table,w=j._field,k=j._value,C=j._time,o.push({table:y,_field:w,_value:k,_time:C});case 26:h=!1,e.next=19;break;case 29:e.next=35;break;case 31:e.prev=31,e.t0=e.catch(17),x=!0,f=e.t0;case 35:if(e.prev=35,e.prev=36,!h||null==p.return){e.next=40;break}return e.next=40,p.return();case 40:if(e.prev=40,!x){e.next=43;break}throw f;case 43:return e.finish(40);case 44:return e.finish(35);case 45:return console.log("\nIterateRows SUCCESS"),S=ne(t,o),e.abrupt("return",S);case 48:case"end":return e.stop()}}),e,null,[[17,31,35,45],[36,,40,44]])})))).apply(this,arguments)}var ae=function(e,t,n){return re.apply(this,arguments)},ie=(n(6919),n(1319)),se=n(8499),oe=(0,l.lazy)((function(){return Promise.all([n.e(348),n.e(841),n.e(128)]).then(n.bind(n,9290))})),le=function(){var e=(0,l.useState)(!1),t=(0,o.Z)(e,2),n=t[0],k=t[1],C=(0,l.useState)(null),S=(0,o.Z)(C,2),_=S[0],P=S[1],z=(0,l.useState)(),H=(0,o.Z)(z,2),D=H[0],E=H[1],M=(0,l.useState)(Date.now()),L=(0,o.Z)(M,2),O=L[0],I=L[1],W=(0,l.useState)(Date.now()),F=(0,o.Z)(W,2),q=F[0],G=F[1],Q=(0,l.useState)(),U=(0,o.Z)(Q,2),J=U[0],B=U[1],V=(0,l.useState)(!1),ee=(0,o.Z)(V,2),te=ee[0],ne=ee[1],re=(0,l.useState)(""),le=(0,o.Z)(re,2),ce=le[0],de=le[1],ue=l.useState({left:!1}),he=(0,o.Z)(ue,2),xe=he[0],fe=he[1],pe=(0,l.useState)([]),ge=(0,o.Z)(pe,2),me=ge[0],be=ge[1],Ze=(0,$.Z)(),ve=(0,o.Z)(Ze,2),je=ve[0],ye=ve[1],we=(0,c.I0)(),ke=(0,c.v9)((function(e){return e.login.token.access})),Ce=(0,c.v9)((function(e){return e.login.token.refresh})),Se=(0,c.v9)((function(e){return e.analytic.selectedTags})),Te=(0,l.useRef)(null),Ae=function(e){ne(e)},_e=function(){var e=(0,s.Z)((0,i.Z)().mark((function e(t){var n,r,a,s,o;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t,e.next=3,X.YM(Te.current,{cacheBust:!0});case 3:r=e.sent,a=t,(s=document.createElement("a")).download="".concat(a,".jpeg"),s.href=r,o=function(e,t){for(var n=e.split(","),r=n[0].match(/:(.*?);/)[1],a=atob(n[1]),i=a.length,s=new Uint8Array(i);i--;)s[i]=a.charCodeAt(i);return new File([s],t,{type:r})}(r,s.download),i=q,O?i||(console.log(!0),Ae(!0),de("Check if you have set the range end time!")):(console.log(!0),Ae(!0),de("Check if you have set the range start time!")),we((0,ie.vB)(Ce)),(0,ie.V0)(ke,o,Se,O,q,J,n);case 13:case"end":return e.stop()}var i}),e)})));return function(t){return e.apply(this,arguments)}}(),Pe=function(e,t){return function(n){P(n.currentTarget),k(!0),E(e),B(t)}},ze=(0,j.ZP)(h.Z)((function(e){return{color:e.theme.palette.getContrastText(y.Z[500]),backgroundColor:y.Z[500],border:"0px",height:ye-76,borderRadius:"0px","&:hover":{backgroundColor:y.Z[700]}}})),He=function(e,t){return function(n){(!n||"keydown"!==n.type||"Tab"!==n.key&&"Shift"!==n.key)&&fe((0,a.Z)((0,a.Z)({},xe),{},(0,r.Z)({},e,t)))}};return(0,T.jsxs)(p.Z,{children:[(0,T.jsxs)(f.Z,{container:!0,children:[(0,T.jsx)(f.Z,{xs:1,children:(0,T.jsx)(ze,{onClick:He("left",!0),sx:{boxShadow:6},variant:"contained",children:(0,T.jsx)(x.Z,{})})}),(0,T.jsx)(f.Z,{xs:11,children:(0,T.jsx)(Z.Z,{children:void 0!==me.data?(0,T.jsx)(oe,{data:me}):(0,T.jsx)(T.Fragment,{})})})]}),(0,T.jsx)(w.Z,{sx:{width:"900px"},disableBackdropTransition:!0,anchor:"left",open:xe.left,onClose:He("left",!1),onOpen:He("left",!0),children:(0,T.jsxs)(f.Z,{container:!0,children:[(0,T.jsx)(f.Z,{xs:4,children:(0,T.jsx)(R,{height:ye,checkTags:se.e1,selectedTags:Se})}),(0,T.jsx)(f.Z,{xs:4,children:(0,T.jsx)(Y,{height:ye,width:je,checkTags:se.e1,selectedTags:Se})}),(0,T.jsxs)(f.Z,{xs:3,children:[(0,T.jsxs)(b.Z,{sx:{m:2,p:3,width:"300px"},elevation:10,square:!0,children:[(0,T.jsx)(u._,{dateAdapter:d.H,children:(0,T.jsxs)(v.Z,{spacing:3,children:[(0,T.jsx)(m.Z,{children:"Date & Time pickers"}),(0,T.jsx)(N,{label:"Start date & time",handler:function(e){I(e)},value:O}),(0,T.jsx)(g.Z,{}),(0,T.jsx)(N,{label:"End date & time",handler:function(e){G(e)},value:q})]})}),(0,T.jsx)(A,{isPopOpen:n,popAnchorEl:_,popPlacement:D,closePopperHandle:function(e,t){if(t)return e?(_e(e),void k(!1)):(Ae(!0),void de("Check if you have set the dataset name!"));k(!1)}})]}),(0,T.jsxs)(b.Z,{sx:{mt:10,m:2,p:3,width:"300px"},elevation:10,square:!0,children:[(0,T.jsx)(h.Z,{onClick:Pe("right",!0),sx:{m:1,position:"senter",height:"50px",marginLeft:"auto",marginRight:"auto"},variant:"contained",size:"large",fullWidth:!0,children:"Save set as historical"}),(0,T.jsx)(h.Z,{onClick:Pe("right",!1),sx:{m:1,position:"senter",height:"50px",marginLeft:"auto",marginRight:"auto"},variant:"contained",size:"large",fullWidth:!0,children:"Save set as realtime"}),(0,T.jsx)(h.Z,{onClick:function(){ae(Se,O,q).then((function(e){return be(e)}))},sx:{m:1,position:"senter",height:"50px",marginLeft:"auto",marginRight:"auto"},variant:"contained",size:"large",color:"warning",fullWidth:!0,children:"Show historical Trand"}),(0,T.jsx)(h.Z,{sx:{m:1,position:"senter",height:"50px",marginLeft:"auto",marginRight:"auto"},variant:"contained",size:"large",color:"success",fullWidth:!0,children:"Show realtime Trand"})]}),(0,T.jsx)(K,{alertOpen:te,setAlertStateHandler:Ae,alertMessage:ce})]}),(0,T.jsx)(f.Z,{style:{display:"flex",flexDirection:"row",justifyContent:"flex-end",flexWrap:"nowrap",alignContent:"center",alignItems:"center"},xs:1,children:(0,T.jsx)(ze,{onClick:He("left",!1),style:{height:ye},sx:{boxShadow:6},variant:"contained",children:(0,T.jsx)(x.Z,{style:{transform:"rotate(180deg)"}})})})]})})]})}}}]);
//# sourceMappingURL=Analytic.af27f079.chunk.js.map